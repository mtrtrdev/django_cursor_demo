# 在庫管理システム アプリケーション仕様書

## 1. はじめに
本仕様書は、PythonのWebフレームワークであるDjangoを用いて開発するシンプルな在庫管理システムの**機能要件**、**データモデル**、**ユーザーインターフェース（UI）/ユーザー体験（UX）**、および**システム構成**を詳細に定義することを目的とします。これにより、開発チームとステークホルダー間での認識の統一を図り、効率的かつ高品質なシステム開発を推進します。

## 2. システム概要
本システムは、企業や個人が保有する商品の在庫を効率的に管理することを目的とします。主要な機能として、**商品名**と**数量**を管理対象とし、在庫アイテムの**登録 (Create)**、**閲覧 (Read)**、**編集 (Update)**、**削除 (Delete)** という基本的なCRUD操作を提供します。ユーザーは直感的なインターフェースを通じて、現在の在庫状況を把握し、必要な操作を簡単に行うことができます。

## 3. 機能要件
本システムは、以下の具体的な機能要件を満たす必要があります。

### 3.1. 在庫アイテム管理機能
#### 3.1.1. アイテム一覧表示
*   **目的:** 登録されているすべての在庫アイテムを一覧形式でユーザーに表示し、現在の在庫状況を把握させる。
*   **表示項目:**
    *   `商品名 (name)`: アイテムを一意に識別するための名称。
    *   `数量 (quantity)`: アイテムの現在の在庫数。
*   **機能:**
    *   登録されているすべての在庫アイテムが、テーブル形式で整然と表示されます。
    *   各アイテムの行には、そのアイテムの**詳細表示**、**編集**、**削除**機能への直接リンクが提供されます。
    *   （オプション）多数のアイテムが存在する場合を考慮し、ページネーション機能の導入も検討されます。
    *   （オプション）商品名や数量でのソート機能も将来的な拡張として検討されます。
*   **UI/UX:** 視認性が高く、一目で全体の在庫状況が把握できるレイアウトとします。
*   **アクセスURL:** `/inventory/list/` からアクセス可能です。

#### 3.1.2. アイテム詳細表示
*   **目的:** 特定の在庫アイテムに関する詳細な情報をユーザーに提供する。
*   **表示項目:**
    *   `商品名 (name)`
    *   `数量 (quantity)`
    *   `作成日時 (created_at)`: アイテムがシステムに登録された日時。
    *   `更新日時 (updated_at)`: アイテム情報が最後に更新された日時。
*   **機能:**
    *   選択された在庫アイテムの全ての詳細情報が表示されます。
    *   詳細情報画面から直接、当該アイテムの**編集画面**および**削除確認画面**へのリンクが提供されます。
    *   一覧画面へ戻るためのナビゲーションも提供されます。
*   **UI/UX:** 必要な情報が明確に表示され、次の操作への導線が分かりやすいデザインとします。
*   **アクセスURL:** `/inventory/<pk>/` （例: `/inventory/1/`）からアクセス可能です。

#### 3.1.3. 新規アイテム追加
*   **目的:** 新しい在庫アイテムをシステムに登録するための入力フォームを提供する。
*   **入力項目:**
    *   `商品名 (name)`: 必須項目。最大200文字。一意性を保証。
    *   `数量 (quantity)`: 必須項目。非負の整数（0以上）。デフォルト値は0。
*   **機能:**
    *   ユーザーは商品名と数量を入力し、新しいアイテムを登録できます。
    *   入力されたデータは、以下のルールに基づいて**厳密にバリデーション**されます。
        *   `商品名`: 空欄不可。既存の商品名との重複不可。最大文字数（200文字）超過不可。
        *   `数量`: 空欄不可。整数以外の入力不可。負の数（マイナス値）入力不可。
    *   バリデーションエラーが発生した場合、具体的なエラーメッセージをユーザーに分かりやすく表示し、再入力を促します。
    *   登録が成功した場合、アイテム一覧画面へ自動的にリダイレクトし、成功メッセージを表示します。
    *   「保存」ボタンと「一覧に戻る」ボタンを提供します。
*   **UI/UX:** 入力フィールドは明確にラベル付けされ、ユーザーが迷わずに操作できるシンプルなフォームとします。
*   **アクセスURL:** `/inventory/new/` からアクセス可能です。

#### 3.1.4. アイテム編集
*   **目的:** 既存の在庫アイテムの情報を変更するための入力フォームを提供する。
*   **入力項目:**
    *   `商品名 (name)`: 必須項目。最大200文字。一意性を保証。
    *   `数量 (quantity)`: 必須項目。非負の整数（0以上）。
*   **機能:**
    *   選択されたアイテムの現在の情報がフォームに事前に設定された状態で表示されます。
    *   ユーザーは商品名と数量を編集し、更新できます。
    *   新規アイテム追加と同様に、入力されたデータは**厳密にバリデーション**されます。
    *   バリデーションエラーが発生した場合、具体的なエラーメッセージをユーザーに分かりやすく表示し、再入力を促します。
    *   更新が成功した場合、アイテム詳細画面へ自動的にリダイレクトし、成功メッセージを表示します。
    *   「保存」ボタンと「一覧に戻る」ボタンを提供します。
*   **UI/UX:** 新規追加画面と同様に、分かりやすいフォームデザインとします。
*   **アクセスURL:** `/inventory/<pk>/edit/` （例: `/inventory/1/edit/`）からアクセス可能です。

#### 3.1.5. アイテム削除
*   **目的:** 特定の在庫アイテムをデータベースから削除するための確認画面を提供する。
*   **機能:**
    *   ユーザーがアイテム削除を試みる際に、対象アイテム名を表示し、本当に削除して良いかどうかの**確認メッセージ**が表示されます。
    *   ユーザーが「削除」ボタンをクリックした場合のみ、アイテムがデータベースから完全に削除されます。
    *   削除が実行された後、アイテム一覧画面へ自動的にリダイレクトし、削除成功メッセージを表示します。
    *   「キャンセル」ボタンを提供し、これをクリックすると削除せずにアイテム詳細画面に戻ります。
*   **UI/UX:** 誤操作を防ぐため、確認メッセージは明確に表示され、削除とキャンセルの選択肢が分かりやすく配置されます。
*   **アクセスURL:** `/inventory/<pk>/delete/` （例: `/inventory/1/delete/`）からアクセス可能です。

## 4. データモデル
本システムで管理する主要なデータは、単一の `Item` モデルとして定義されます。このモデルは、データベースのテーブル構造に対応します。

### 4.1. Item モデル
| フィールド名   | データ型             | 説明                                     | 備考                                                              |
| :------------- | :------------------- | :--------------------------------------- | :---------------------------------------------------------------- |
| `id`           | `AutoField`          | レコードの一意な識別子（主キー）         | Djangoが自動的に管理する連番の整数。                                  |
| `name`         | `CharField(max_length=200, unique=True)` | 商品名                                   | 最大200文字。`unique=True`により、同じ商品名のアイテムは登録できません。必須項目。 |
| `quantity`     | `IntegerField`       | 在庫数量                                 | 整数型。`min_value=0`として非負の値のみを許可します。デフォルト値は0。必須項目。 |
| `created_at`   | `DateTimeField`      | アイテムが最初に作成された日時           | アイテムがデータベースに保存される際に自動的に現在時刻が設定されます。読み取り専用。 |
| `updated_at`   | `DateTimeField`      | アイテム情報が最後に更新された日時       | アイテムが更新されるたびに自動的に現在時刻が更新されます。読み取り専用。 |

## 5. UI/UX (ユーザーインターフェース/ユーザー体験)
本システムは、ユーザーにとって使いやすく、情報を把握しやすいインターフェースを提供することを重視します。

### 5.1. 画面構成
各主要画面は、以下の構成要素を持ちます。

#### 5.1.1. 在庫アイテム一覧画面 (`item_list.html`)
*   **ヘッダー:** 「在庫アイテム一覧」というタイトルを表示。
*   **ナビゲーション/アクション:** 右上または目立つ位置に「新しいアイテムを追加」ボタンを配置。
*   **メインコンテンツ:** テーブル形式でアイテム情報を表示。
    *   テーブルヘッダー: 「商品名」「数量」「操作」
    *   各行: 商品名、数量を表示し、「詳細」「編集」「削除」へのリンクボタンを配置。
*   **フッター:** 特になし。
*   **その他:** 在庫アイテムが一件もない場合は、「現在、登録されているアイテムはありません。新しいアイテムを追加してください。」といったメッセージと、「新しいアイテムを追加」ボタンのみを表示します。

#### 5.1.2. 在庫アイテム詳細画面 (`item_detail.html`)
*   **ヘッダー:** 選択されたアイテムの`商品名`を表示（例: 「りんごの詳細」）。
*   **メインコンテンツ:**
    *   商品名、数量、作成日時、更新日時を分かりやすく表示。
*   **ナビゲーション/アクション:**
    *   「編集」ボタン
    *   「削除」ボタン
    *   「一覧に戻る」ボタン
*   **フッター:** 特になし。

#### 5.1.3. 在庫アイテム追加/編集画面 (`item_form.html` または `item_edit.html`)
*   **ヘッダー:** 新規追加時は「新規アイテム追加」、編集時は「アイテム編集」というタイトルを表示。
*   **メインコンテンツ:**
    *   フォームフィールド:
        *   `商品名`: テキスト入力フィールド。プレースホルダーテキストや入力例を表示。
        *   `数量`: 数値入力フィールド。最小値0を示唆。
    *   各フィールドには対応するラベルを表示。
    *   バリデーションエラーが発生した場合、該当フィールドの下に赤字でエラーメッセージを表示。
*   **ナビゲーション/アクション:**
    *   「保存」ボタン (新規追加/編集共通)
    *   「一覧に戻る」ボタン
*   **フッター:** 特になし。

#### 5.1.4. 在庫アイテム削除確認画面 (`item_confirm_delete.html`)
*   **ヘッダー:** 「`[アイテム名]` を削除しますか？」という確認タイトルを表示。
*   **メインコンテンツ:**
    *   「この操作は元に戻せません。本当に `[アイテム名]` を削除してもよろしいですか？」という具体的な確認メッセージを表示。
*   **ナビゲーション/アクション:**
    *   「削除」ボタン（強調表示）
    *   「キャンセル」ボタン (詳細画面に戻る)
*   **フッター:** 特になし。

### 5.2. デザインコンセプト
*   **シンプル & 視認性:** 過度な装飾を避け、必要な情報が明確に、かつ一目で理解できるようにデザインします。文字サイズ、行間、色のコントラストに配慮します。
*   **技術スタック:** 基本的なHTMLとCSSのみを使用し、複雑なJavaScriptや外部UIライブラリは初期段階では使用しません。これにより、開発の複雑性を抑え、パフォーマンスを維持します。
*   **レスポンシブ対応:** 小規模ながらも、異なる画面サイズ（特にモバイルデバイス）での基本的な表示崩れを防ぐための、最低限のレスポンシブデザインをCSSメディアクエリを用いて実装します。

## 6. システム構成
本システムの技術的な構成要素と、アプリケーションの論理的な構造を定義します。

### 6.1. フレームワーク・言語
*   **バックエンド:** Python 言語と Django フレームワーク（最新の安定版）を使用します。DjangoのMVT (Model-View-Template) パターンを最大限に活用します。
*   **フロントエンド:** 標準的なHTML5とCSS3を使用します。JavaScriptは、必要最小限のインタラクション（例: フォーム送信時のシンプルバリデーション）に限定的に使用する可能性があります。

### 6.2. データベース
*   **開発環境:** Djangoのデフォルト設定であるSQLite3を使用します。これにより、開発初期段階での環境構築が容易になります。
*   **本番環境:** スケーラビリティ、堅牢性、並行処理性能を考慮し、PostgreSQLやMySQLなどの堅牢なリレーショナルデータベース管理システム（RDBMS）への移行を想定します。データ移行プロセスも計画段階で考慮します。

### 6.3. アプリケーション構造
Djangoプロジェクトは、以下の主要なファイルとディレクトリ構造を持ちます。

*   `inventory_system/` (プロジェクトルートディレクトリ):
    *   `settings.py`: プロジェクト全体の基本設定ファイル。データベース接続、アプリケーションの登録、静的ファイルのパスなどを定義。
    *   `urls.py`: プロジェクトURLルーティング。**ルートURL (`/`) にはトップページが、`/stock/` にはトップページへのリダイレクトが、`/inventory/` 以下には在庫管理アプリケーションのURLがルーティングされます。**
    *   `wsgi.py`: WSGI互換のWebサーバーでプロジェクトを動かすためのエントリーポイント。
    *   `asgi.py`: ASGI互換のWebサーバーでプロジェクトを動かすためのエントリーポイント（非同期処理が必要な場合）。
*   `stock/` (アプリケーションディレクトリ):
    *   `models.py`: データベースの `Item` モデル定義。ビジネスオブジェクトの構造を定義します。
    *   `views.py`: ビジネスロジックを実装する「コントローラー」の役割。HTTPリクエストを処理し、モデルとテンプレートを連携させます。**トップページ用のビュー (`TopPageView`) も含まれます。**
    *   `forms.py`: Djangoの `Form` クラスを利用したフォーム定義。ユーザー入力のバリデーションと処理を担います。
    *   `urls.py`: `stock` アプリケーション固有のURLルーティング定義ファイル。**`/inventory/` 以下にマッピングされる各ビュー関数へのパス（例: `/inventory/list/`, `/inventory/new/` など）を定義します。**
    *   `templates/stock/`: HTMLテンプレートファイル（UI部分）を格納するディレクトリ。
        *   `top_page.html`: トップページ用テンプレート。
        *   `item_list.html`: アイテム一覧表示用テンプレート。
        *   `item_detail.html`: アイテム詳細表示用テンプレート。
        *   `item_form.html`: 新規追加・編集フォーム共通テンプレート。
        *   `item_confirm_delete.html`: 削除確認用テンプレート。
    *   `migrations/`: モデルの変更をデータベースに適用するためのマイグレーションファイルが自動生成されます。
    *   `admin.py`: Django管理サイトにモデルを登録するためのファイル。
    *   **`fixtures/`: 初期データファイル（例: `initial_data.json`）を格納します。**
    *   **`tests.py`: アプリケーションのユニットテストおよび統合テストコードを格納します。**

## 7. 開発手順（フェーズ）
以下のステップで開発を進めます。

1.  **Djangoプロジェクトおよびアプリケーションのセットアップ:** `django-admin startproject` および `python manage.py startapp` コマンドを使用して基本的なプロジェクト構造を構築します。
2.  **Item モデルの定義とDBマイグレーションの実行:** `stock/models.py` に `Item` モデルを定義し、`makemigrations` および `migrate` コマンドでデータベーススキーマを作成します。
3.  **フォーム (ItemForm) の作成:** `stock/forms.py` に `ItemForm` を定義し、データバリデーションとHTMLフォームの生成を効率化します。
4.  **各機能（一覧、詳細、新規、編集、削除、トップページ）に対応するビュー（コントローラー）の作成:** `stock/views.py` に、各機能に対応するPython関数（またはクラスベースビュー）を実装します。これらはHTTPリクエストを受け取り、モデルと連携してデータ処理を行い、適切なテンプレートにデータを渡します。
5.  **URLルーティングの設定:** `inventory_system/urls.py` にプロジェクト全体のURL（ルートパス、`/stock/` のリダイレクト、`/inventory/` へのルーティング）を、`stock/urls.py` にアプリケーション内のURL（`/inventory/list/`、`/inventory/new/` など）を定義します。
6.  **各機能に対応するHTMLテンプレート（UI）の作成:** `stock/templates/stock/` ディレクトリ内に、各ビューによってレンダリングされるHTMLテンプレートを作成します。ここでは、Djangoテンプレート言語（DTL）を使用し、動的なデータを表示します。
7.  **開発サーバーでの動作確認とテスト:** `python manage.py runserver` を使用して開発サーバーを起動し、ブラウザを通じてシステムが意図通りに動作するかを確認します。ユニットテストや統合テストも適宜実施します。

## 8. 今後の拡張性（オプション）
本システムの今後の機能拡張として、以下の項目が検討されます。

*   **ユーザー認証・認可機能の追加:** ログインシステムを導入し、ユーザーごとにアクセス権限を管理します。
*   **検索・絞り込み機能:** アイテム一覧画面に、商品名や数量範囲でアイテムを検索・絞り込む機能を追加します。
*   **在庫変動履歴の記録:** アイテムの数量が変更された際に、いつ、誰が、どのように変更したかの履歴を記録する機能を追加します。
*   **AJAXを用いた非同期処理:** フォーム送信やデータ更新時にページ全体のリロードを伴わない、よりスムーズなユーザー体験を提供します。
*   **よりリッチなUIフレームワークの導入:** BootstrapやTailwind CSSなどのCSSフレームワーク、またはReact/Vue/AngularなどのJavaScriptフレームワークを導入し、より高度なUI/UXを実現します。
*   **APIエンドポイントの提供:** 外部システムとの連携を可能にするためのRESTful APIエンドポイントを実装します。